# MCP-Server-DebugTool
一个（比Anthropic官方Inspector工具）轻量化的MCP服务浏览器调试工具
# MCP Server Debug Tool\n\n一个基于浏览器的 MCP (Model Context Protocol) 服务器调试工具，用于测试和调试各种 MCP 服务器实现。本项目是 Anthropic 官方 Inspector 工具的简化版本，全部代码由 Claude 生成。\n\n## 项目结构\n\n### 核心文件\n\n#### `index.html`\n主界面文件，包含：\n- 连接配置界面（传输类型选择、服务器配置）\n- 工具标签显示区域\n- 工具详情和参数输入区域  \n- 执行结果显示区域\n- 调试功能按钮\n\n#### `src/app.js`\n应用程序主入口，包含主要方法：\n- `connectServer()` - 连接 MCP 服务器\n- `disconnectServer()` - 断开服务器连接\n- `testConnection()` - 测试连接状态\n- `showConnectionInfo()` - 显示连接详细信息\n- `exportLogs()` - 导出调试日志\n\n#### `src/core/mcp-client.js`\nMCP 客户端核心类 `MCPDebugClient`，主要方法：\n- `connect(transport, serverConfig)` - 建立 MCP 连接\n- `initialize()` - 执行 MCP 协议握手\n- `loadCapabilities()` - 加载服务器能力\n- `loadTools()` - 加载工具列表\n- `loadResources()` - 加载资源列表\n\n#### `src/debugger/tool-debugger.js`\n工具调试器类 `ToolDebugger`，主要方法：\n- `loadTools()` - 加载并渲染工具标签\n- `selectTool(tool)` - 选择工具并显示详情\n- `executeTool()` - 执行选中的工具\n- `collectParams()` - 收集用户输入的参数\n- `displayResult(result)` - 显示执行结果\n- `quickTest(toolName, params)` - 快速测试工具\n- `batchTest()` - 批量测试所有工具\n\n### 传输层实现\n\n#### `src/transport/stdio-transport.js`\n标准输入输出传输实现 `StdioTransport`，主要方法：\n- `connect()` - 通过 WebSocket 代理连接到 MCP 进程\n- `send(method, params)` - 发送 JSON-RPC 请求\n- `sendNotification(method, params)` - 发送通知消息\n- `handleMessage(event)` - 处理来自代理的响应\n\n#### `src/transport/http-transport.js` ⚠️\nHTTP 传输实现 `HTTPTransport`，主要方法：\n- `send(method, params)` - 通过 HTTP POST 发送请求\n\n#### `src/transport/websocket-transport.js` ⚠️\nWebSocket 传输实现 `WebSocketTransport`，主要方法：\n- `send(method, params)` - 通过 WebSocket 发送请求\n- `onMessage(event)` - 处理 WebSocket 消息\n\n#### `proxy-server.js`\nNode.js 代理服务器，主要功能：\n- 启动 WebSocket 服务器监听浏览器连接\n- 通过 `spawn` 启动 MCP 进程\n- 在浏览器和 MCP 进程间转发 JSON-RPC 消息\n- 处理进程生命周期管理\n\n## 安装指南\n\n### 环境要求\n- Node.js 14.0.0 或更高版本\n- Windows 操作系统\n- Chrome 浏览器\n\n### 安装步骤\n\n1. 克隆项目到本地：\n```bash\ngit clone https://github.com/Peng2017/MCP-Server-DebugTool.git\ncd MCP-Server-DebugTool\n```\n\n2. 安装依赖：\n```bash\nnpm install\n```\n\n## 使用指南\n\n### 启动服务\n\n1. **启动代理服务器**（在第一个终端窗口）：\n```bash\nnpm run proxy\n```\n代理服务器将在端口 3001 启动，用于在浏览器和 MCP 进程间转发消息。\n\n2. **启动 Web 服务器**（在第二个终端窗口）：\n```bash\nnpm start\n```\nWeb 服务器将在端口 8080 启动。\n\n3. **打开浏览器**：\n```\nhttp://localhost:8080\n```\n\n### 配置说明\n\n#### 端口配置\n- **Web 服务器端口**：修改 `package.json` 中 `start` 脚本的 `-p 8080` 参数\n- **代理服务器端口**：修改 `proxy-server.js` 中的 `port = 3001` 参数\n- 如果修改代理端口，还需要更新 `src/transport/stdio-transport.js` 中的 `this.proxyUrl = config.proxyUrl || 'ws://localhost:3001'`\n\n#### MCP 服务器配置\n在浏览器界面的配置区域输入 MCP 服务器配置，例如：\n```json\n{\n  \"command\": \"npx\",\n  \"args\": [\n    \"-y\",\n    \"@modelcontextprotocol/server-filesystem\",\n    \"C:\\\\allowed\\\\directory\"\n  ]\n}\n```\n\n### 使用说明\n\n1. **连接服务器**：\n   - 选择传输类型（目前推荐使用 \"stdio\"）\n   - 输入 MCP 服务器配置 JSON\n   - 点击 \"Connect\" 按钮\n\n2. **测试工具**：\n   - 连接成功后，工具标签会自动显示\n   - 点击工具标签查看详情和参数\n   - 填写参数后点击 \"执行工具\" 测试\n\n3. **调试功能**：\n   - `testConnection()` - 在控制台检查连接状态\n   - `showConnectionInfo()` - 显示详细连接信息\n   - `exportLogs()` - 导出调试日志\n   - `quickTest(toolName, params)` - 快速测试特定工具\n\n### Chrome 调试\n\n1. 按 F12 打开开发者工具\n2. 在 Console 标签中可以：\n   - 查看详细的连接和执行日志\n   - 使用调试函数（如 `testConnection()`）\n   - 检查全局变量 `mcpClient` 和 `toolDebugger`\n3. 在 Network 标签中可以查看 WebSocket 连接状态\n\n## TODO\n\n以下功能尚未完全实现：\n\n### HTTP Transport (`src/transport/http-transport.js`)\n- 基础框架已实现，但缺少：\n  - 连接管理和状态检查\n  - 错误处理和重试机制\n  - 与 MCP 协议的完整集成\n  - 需要对应的 HTTP MCP 服务器支持\n\n### WebSocket Transport (`src/transport/websocket-transport.js`)  \n- 基础框架已实现，但缺少：\n  - `connect()` 方法实现\n  - 连接状态管理\n  - 错误处理和重连逻辑\n  - 消息队列和超时处理\n  - 需要对应的 WebSocket MCP 服务器支持\n\n目前项目主要支持通过 stdio 传输与 MCP 服务器通信，这是最常见和稳定的连接方式。\n\n## 运行截图\n\n![项目运行截图](./screenshots/running-example.png)
